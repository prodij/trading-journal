FROM oven/bun:1-alpine
WORKDIR /app

COPY app/package.json app/bun.lock* ./
RUN bun install --frozen-lockfile

COPY app/ .

RUN mkdir -p /app/data

EXPOSE 3000 4000

# Run Vite dev server + Hono with --watch concurrently
CMD ["sh", "-c", "bun run --watch src/server/index.ts & bunx vite --host 0.0.0.0"]
